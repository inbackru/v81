{% extends "base.html" %}

{% block title %}{{ district_data.name }} - Район {{ current_city.name_genitive if current_city else 'Краснодара' }} с кэшбеком до 5% | Новостройки {{ district_data.name }} | InBack{% endblock %}

{% block meta %}
<meta name="description" content="Район {{ district_data.name }} в {{ current_city.name_prepositional if current_city else 'Краснодаре' }}: {{ district_data.description }} ✅ {{ district_data.properties_count }} новостроек ✅ Кэшбек до {{ (district_data.avg_cashback | int / 1000) | int }}к₽ ✅ Инфраструктура, транспорт, цены">
<meta name="keywords" content="район {{ district_data.name }}, {{ district_data.name }} {{ current_city.name if current_city else 'Краснодар' }}, недвижимость {{ district_data.name }}, новостройки {{ district_data.name }}, купить квартиру {{ district_data.name }}, {{ district_data.keywords }}, жк {{ district_data.name }}, застройщики {{ district_data.name }}">
<meta name="robots" content="index, follow">
<meta name="author" content="InBack">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:title" content="{{ district_data.name }} - {{ district_data.properties_count }} новостроек с кэшбеком до 5%">
<meta property="og:description" content="{{ district_data.description }} Инфраструктура: {{ district_data.infrastructure.schools }} школ, {{ district_data.infrastructure.hospitals }} больниц, {{ district_data.infrastructure.malls }} ТЦ">
<meta property="og:image" content="{{ request.url_root }}{{ url_for('static', filename='images/districts/' + district_data.image)[1:] }}">
<meta property="og:url" content="{{ request.url }}">
<meta property="og:site_name" content="InBack">
<meta property="og:locale" content="ru_RU">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ district_data.name }} - Район {{ current_city.name_genitive if current_city else 'Краснодара' }} с кэшбеком">
<meta name="twitter:description" content="{{ district_data.description }}">
<meta name="twitter:image" content="{{ request.url_root }}{{ url_for('static', filename='images/districts/' + district_data.image)[1:] }}">

<link rel="canonical" href="{{ request.url }}">

<!-- JSON-LD Schema -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Place",
  "name": "Район {{ district_data.name }}",
  "description": "{{ district_data.description }}",
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": "45.035470",
    "longitude": "38.975313"
  },
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "{{ current_city.name if current_city else 'Краснодар' }}",
    "addressRegion": {{ (current_city.region.name if current_city and current_city.region else 'Краснодарский край')|tojson }},
    "addressCountry": "RU"
  },
  "containsPlace": [
    {% for school in district_data.infrastructure.schools_list %}
    {
      "@type": "School",
      "name": "{{ school }}"
    }{% if not loop.last %},{% endif %}
    {% endfor %}
  ],
  "amenityFeature": [
    {
      "@type": "LocationFeatureSpecification",
      "name": "Школы",
      "value": "{{ district_data.infrastructure.schools }}"
    },
    {
      "@type": "LocationFeatureSpecification", 
      "name": "Детские сады",
      "value": "{{ district_data.infrastructure.kindergartens }}"
    },
    {
      "@type": "LocationFeatureSpecification",
      "name": "Больницы и поликлиники", 
      "value": "{{ district_data.infrastructure.hospitals + district_data.infrastructure.clinics }}"
    }
  ]
}
</script>
{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-b from-white to-gray-50">
    <!-- Hero Section -->
    <section class="py-16 md:py-20 bg-gradient-to-b from-white to-gray-50">
        <div class="container mx-auto px-4 text-center">
            <nav class="text-gray-500 mb-6">
                <a href="/" class="hover:text-blue-600">Главная</a>
                <span class="mx-2">→</span>
                <a href="/districts" class="hover:text-blue-600">Районы</a>
                <span class="mx-2">→</span>
                <span class="text-gray-900">{{ district_data.name }}</span>
            </nav>
            <h1 class="text-4xl lg:text-5xl font-bold mb-4 text-gray-900">Район {{ district_data.name }}</h1>
            <p class="text-xl lg:text-2xl text-gray-600 mb-8">{{ district_data.subtitle }}</p>
            <div class="flex flex-wrap justify-center gap-4">
                <span class="bg-blue-100 px-4 py-2 rounded-full text-blue-700">
                    <i class="fas fa-building mr-2"></i>{{ district_data.properties_count }} объектов
                </span>
                <span class="bg-gray-100 px-4 py-2 rounded-full text-gray-700">
                    <i class="fas fa-map-marker-alt mr-2"></i>{{ district_data.area_type }}
                </span>
                <span class="bg-blue-100 px-4 py-2 rounded-full text-blue-700">
                    <i class="fas fa-percent mr-2"></i>Кэшбек до 5%
                </span>
            </div>
        </div>
    </section>

    <div class="container mx-auto px-4 py-12">
        <div class="grid lg:grid-cols-3 gap-8">
            <!-- Main Content -->
            <div class="lg:col-span-2">
                <!-- District Overview -->
                <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
                        <i class="fas fa-info-circle text-blue-600 mr-3"></i>
                        О районе
                    </h2>
                    <div class="grid md:grid-cols-2 gap-6 mb-6">
                        <div class="relative">
                            <!-- Photo Slider -->
                            <div class="photo-slider relative overflow-hidden rounded-lg" style="height: 300px;">
                                <div class="slider-container flex transition-transform duration-500 ease-in-out h-full" id="sliderContainer">
                                    <div class="slider-slide w-full flex-shrink-0">
                                        <img src="{{ url_for('static', filename='images/districts/' + district_data.image) }}" 
                                             alt="Район {{ district_data.name }}" 
                                             class="w-full h-full object-cover">
                                        <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white p-3">
                                            <p class="text-sm font-medium">Общий вид района</p>
                                        </div>
                                    </div>
                                    <div class="slider-slide w-full flex-shrink-0">
                                        <img src="{{ url_for('static', filename='images/districts/street-' + district + '.jpg') }}" 
                                             alt="Улицы района {{ district_data.name }}" 
                                             class="w-full h-full object-cover"
                                             onerror="this.src='/static/images/districts/overview.png'">
                                        <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white p-3">
                                            <p class="text-sm font-medium">Улицы и инфраструктура</p>
                                        </div>
                                    </div>
                                    <div class="slider-slide w-full flex-shrink-0">
                                        <img src="{{ url_for('static', filename='images/districts/homes-' + district + '.jpg') }}" 
                                             alt="Дома в районе {{ district_data.name }}" 
                                             class="w-full h-full object-cover"
                                             onerror="this.src='/static/images/districts/overview.png'">
                                        <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white p-3">
                                            <p class="text-sm font-medium">Жилые комплексы</p>
                                        </div>
                                    </div>
                                    <div class="slider-slide w-full flex-shrink-0">
                                        <img src="{{ url_for('static', filename='images/districts/park-' + district + '.jpg') }}" 
                                             alt="Парки и зоны отдыха {{ district_data.name }}" 
                                             class="w-full h-full object-cover"
                                             onerror="this.src='/static/images/districts/overview.png'">
                                        <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white p-3">
                                            <p class="text-sm font-medium">Зоны отдыха и парки</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Navigation buttons -->
                                <button onclick="prevSlide()" class="absolute left-2 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-80 hover:bg-opacity-100 rounded-full p-2 shadow-lg transition-all">
                                    <i class="fas fa-chevron-left text-gray-800"></i>
                                </button>
                                <button onclick="nextSlide()" class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-80 hover:bg-opacity-100 rounded-full p-2 shadow-lg transition-all">
                                    <i class="fas fa-chevron-right text-gray-800"></i>
                                </button>
                                
                                <!-- Dot indicators -->
                                <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2">
                                    <button onclick="goToSlide(0)" class="w-2 h-2 rounded-full bg-white bg-opacity-60 hover:bg-opacity-100 transition-all dot-indicator active"></button>
                                    <button onclick="goToSlide(1)" class="w-2 h-2 rounded-full bg-white bg-opacity-60 hover:bg-opacity-100 transition-all dot-indicator"></button>
                                    <button onclick="goToSlide(2)" class="w-2 h-2 rounded-full bg-white bg-opacity-60 hover:bg-opacity-100 transition-all dot-indicator"></button>
                                    <button onclick="goToSlide(3)" class="w-2 h-2 rounded-full bg-white bg-opacity-60 hover:bg-opacity-100 transition-all dot-indicator"></button>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between py-2 border-b border-gray-100">
                                <span class="text-gray-600">Административный округ:</span>
                                <span class="font-medium text-gray-900">{{ district_data.admin_district }}</span>
                            </div>
                            <div class="flex items-center justify-between py-2 border-b border-gray-100">
                                <span class="text-gray-600">Тип застройки:</span>
                                <span class="font-medium text-gray-900">{{ district_data.building_type }}</span>
                            </div>
                            <div class="flex items-center justify-between py-2 border-b border-gray-100">
                                <span class="text-gray-600">Транспорт:</span>
                                <span class="font-medium text-gray-900">
                                    {% set transport_types = [] %}
                                    {% if district_data.transport.bus_routes %}{% set _ = transport_types.append('Автобусы') %}{% endif %}
                                    {% if district_data.transport.tram_routes %}{% set _ = transport_types.append('трамваи') %}{% endif %}
                                    {% if district_data.transport.trolleybus_routes %}{% set _ = transport_types.append('троллейбусы') %}{% endif %}
                                    {{ transport_types|join(', ') }}
                                </span>
                            </div>
                            <div class="flex items-center justify-between py-2">
                                <span class="text-gray-600">Средняя цена м²:</span>
                                <span class="font-bold text-blue-600">{{ district_data.avg_price }} ₽</span>
                            </div>
                        </div>
                    </div>
                    <p class="text-gray-700 leading-relaxed">{{ district_data.description }}</p>
                </div>

                <!-- District Map -->
                <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
                        <i class="fas fa-map-marker-alt text-blue-600 mr-3"></i>
                        Расположение района на карте
                    </h2>
                    <div class="relative" style="height: 500px; border-radius: 12px; overflow: hidden;">
                        <iframe 
                            src="https://yandex.ru/map-widget/v1/?from=mapframe&ll=39.050238%2C45.004708&mode=usermaps&source=mapframe&um=constructor%3A8a251e60a6084099a8c77a77f572b41f44f8890de093572eb01fc123756fd5a8&utm_source=mapframe&z=13.2" 
                            width="100%" 
                            height="500" 
                            frameborder="0"
                            style="border-radius: 12px;"
                            allowfullscreen="true">
                        </iframe>
                    </div>
                    <div class="mt-4 text-sm text-gray-600 flex items-center justify-between">
                        <span><i class="fas fa-info-circle mr-2"></i>Интерактивная карта всех районов {{ current_city.name_genitive if current_city else 'Краснодара' }}</span>
                        <a href="https://yandex.ru/maps/35/krasnodar/?from=mapframe&ll=39.050238%2C45.004708&mode=usermaps&source=mapframe&um=constructor%3A8a251e60a6084099a8c77a77f572b41f44f8890de093572eb01fc123756fd5a8&utm_source=mapframe&z=13.2" 
                           target="_blank" 
                           class="text-blue-600 hover:text-blue-800 transition-colors">
                            <i class="fas fa-external-link-alt mr-1"></i>Открыть в полном размере
                        </a>
                    </div>
                </div>

                <!-- Expert Recommendations -->
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl shadow-sm p-8 mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
                        <i class="fas fa-user-tie text-blue-600 mr-3"></i>
                        Рекомендации экспертов
                    </h2>
                    <div class="bg-white rounded-lg p-6 shadow-sm">
                        <div class="flex items-start space-x-4">
                            <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-user-tie text-blue-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900 mb-2">Андрей Петров</h3>
                                <p class="text-sm text-blue-600 mb-3">Ведущий эксперт по недвижимости InBack</p>
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <p class="text-gray-700 leading-relaxed">
                                        {% if district == 'dubinka' %}
                                        "Дубинка — это уникальный район для тех, кто ценит спокойствие и близость к природе. 
                                        Рекомендую обратить внимание на дома в центральной части района, где лучше развита инфраструктура. 
                                        Идеально подходит для семей с детьми благодаря тихим улицам и зеленым зонам."
                                        {% elif district == 'festivalny' %}
                                        "ФМР — топовый выбор для активных людей. Район предлагает отличную инфраструктуру и транспортную доступность. 
                                        Советую рассматривать новостройки рядом с ТЦ 'Галерея Краснодар' — это зона активного развития с хорошими перспективами роста стоимости."
                                        {% elif district == 'tsentralnyy' %}
                                        "Центральный район — это престиж и удобство. Высокая ликвидность недвижимости компенсирует первоначальные вложения. 
                                        Рекомендую квартиры в исторических зданиях после реновации — они сочетают шарм и современный комфорт."
                                        {% elif district == 'gidrostroitelei' %}
                                        "ГМР — отличный баланс цены и качества. Район активно развивается, появляются новые объекты социальной инфраструктуры. 
                                        Советую рассматривать квартиры рядом с новым парком — в ближайшие годы этот район значительно преобразится."
                                        {% else %}
                                        "{{ district_data.name }} — перспективный район для инвестиций. {{ district_data.area_type|lower }} застройка предлагает хорошие возможности для жизни и вложений. 
                                        Рекомендую внимательно изучить транспортную доступность и планы развития инфраструктуры при выборе конкретного объекта."
                                        {% endif %}
                                    </p>
                                </div>
                                <div class="mt-4 flex items-center text-sm text-gray-600">
                                    <i class="fas fa-calendar-alt mr-2"></i>
                                    <span>Консультация от {{ "сегодня" }}</span>
                                    <span class="ml-4 flex items-center">
                                        <i class="fas fa-star text-yellow-400 mr-1"></i>
                                        <span class="font-medium">4.9</span>
                                        <span class="ml-1">(127 отзывов)</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6 text-center">
                        <button onclick="openApplicationModal()" 
                                class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                            <i class="fas fa-phone mr-2"></i>
                            Получить персональную консультацию
                        </button>
                    </div>
                </div>



                <!-- Advantages & Disadvantages -->
                <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Плюсы и минусы</h2>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h3 class="text-lg font-semibold text-blue-700 mb-4 flex items-center">
                                <i class="fas fa-plus-circle mr-2"></i>Преимущества
                            </h3>
                            <ul class="space-y-2">
                                {% for advantage in district_data.advantages %}
                                <li class="flex items-start">
                                    <i class="fas fa-check text-blue-500 mt-1 mr-3"></i>
                                    <span class="text-gray-700">{{ advantage }}</span>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-red-700 mb-4 flex items-center">
                                <i class="fas fa-minus-circle mr-2"></i>Недостатки
                            </h3>
                            <ul class="space-y-2">
                                {% for disadvantage in district_data.disadvantages %}
                                <li class="flex items-start">
                                    <i class="fas fa-times text-red-500 mt-1 mr-3"></i>
                                    <span class="text-gray-700">{{ disadvantage }}</span>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Infrastructure -->
                <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
                        <i class="fas fa-city text-blue-600 mr-3"></i>
                        Инфраструктура района
                    </h2>
                    <!-- Infrastructure Overview Cards -->
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="text-center p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl">
                            <i class="fas fa-graduation-cap text-3xl text-blue-600 mb-4"></i>
                            <h4 class="font-bold text-gray-900 mb-3">Образование</h4>
                            <div class="text-sm text-gray-700 space-y-1">
                                <div class="font-medium">{{ district_data.infrastructure.schools }} школ</div>
                                <div>{{ district_data.infrastructure.kindergartens }} детских садов</div>
                            </div>
                        </div>
                        <div class="text-center p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-xl">
                            <i class="fas fa-stethoscope text-3xl text-blue-600 mb-4"></i>
                            <h4 class="font-bold text-gray-900 mb-3">Медицина</h4>
                            <div class="text-sm text-gray-700 space-y-1">
                                <div class="font-medium">{{ district_data.infrastructure.hospitals }} больниц</div>
                                <div>{{ district_data.infrastructure.clinics }} поликлиник</div>
                            </div>
                        </div>
                        <div class="text-center p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl">
                            <i class="fas fa-shopping-cart text-3xl text-purple-600 mb-4"></i>
                            <h4 class="font-bold text-gray-900 mb-3">Торговля</h4>
                            <div class="text-sm text-gray-700 space-y-1">
                                <div class="font-medium">{{ district_data.infrastructure.malls }} торговых центров</div>
                                <div>{{ district_data.infrastructure.markets }} рынков</div>
                            </div>
                        </div>
                        <div class="text-center p-6 bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-xl">
                            <i class="fas fa-tree text-3xl text-emerald-600 mb-4"></i>
                            <h4 class="font-bold text-gray-900 mb-3">Отдых</h4>
                            <div class="text-sm text-gray-700 space-y-1">
                                <div class="font-medium">{{ district_data.infrastructure.parks }} парков</div>
                                <div>{{ district_data.infrastructure.sports }} спортивных объектов</div>
                            </div>
                        </div>
                    </div>

                    <!-- Detailed Infrastructure Lists -->
                    <div class="grid md:grid-cols-2 gap-8">
                        <!-- Education -->
                        <div class="bg-blue-50 rounded-xl p-6">
                            <h3 class="text-lg font-bold text-blue-900 mb-4 flex items-center">
                                <i class="fas fa-graduation-cap text-blue-600 mr-2"></i>
                                Образовательные учреждения
                            </h3>
                            <div class="space-y-4">
                                <div>
                                    <h4 class="font-semibold text-blue-800 mb-2">Школы и гимназии:</h4>
                                    <ul class="text-sm text-blue-700 space-y-1">
                                        {% for school in district_data.infrastructure.schools_list %}
                                        <li class="flex items-center">
                                            <i class="fas fa-circle text-xs text-blue-400 mr-2"></i>
                                            {{ school }}
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Healthcare -->
                        <div class="bg-blue-50 rounded-xl p-6">
                            <h3 class="text-lg font-bold text-blue-900 mb-4 flex items-center">
                                <i class="fas fa-stethoscope text-blue-600 mr-2"></i>
                                Медицинские учреждения
                            </h3>
                            <div class="space-y-4">
                                <div>
                                    <h4 class="font-semibold text-blue-800 mb-2">Больницы и поликлиники:</h4>
                                    <ul class="text-sm text-blue-700 space-y-1">
                                        {% for hospital in district_data.infrastructure.hospitals_list %}
                                        <li class="flex items-center">
                                            <i class="fas fa-circle text-xs text-blue-400 mr-2"></i>
                                            {{ hospital }}
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Shopping -->
                        <div class="bg-purple-50 rounded-xl p-6">
                            <h3 class="text-lg font-bold text-purple-900 mb-4 flex items-center">
                                <i class="fas fa-shopping-cart text-purple-600 mr-2"></i>
                                Торговые объекты
                            </h3>
                            <div class="space-y-4">
                                <div>
                                    <h4 class="font-semibold text-purple-800 mb-2">Торговые центры:</h4>
                                    <ul class="text-sm text-purple-700 space-y-1">
                                        {% for mall in district_data.infrastructure.malls_list %}
                                        <li class="flex items-center">
                                            <i class="fas fa-circle text-xs text-purple-400 mr-2"></i>
                                            {{ mall }}
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-purple-800 mb-2">Рынки:</h4>
                                    <ul class="text-sm text-purple-700 space-y-1">
                                        {% for market in district_data.infrastructure.markets_list %}
                                        <li class="flex items-center">
                                            <i class="fas fa-circle text-xs text-purple-400 mr-2"></i>
                                            {{ market }}
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Recreation -->
                        <div class="bg-emerald-50 rounded-xl p-6">
                            <h3 class="text-lg font-bold text-emerald-900 mb-4 flex items-center">
                                <i class="fas fa-tree text-emerald-600 mr-2"></i>
                                Отдых и досуг
                            </h3>
                            <div class="space-y-4">
                                <div>
                                    <h4 class="font-semibold text-emerald-800 mb-2">Парки и скверы:</h4>
                                    <ul class="text-sm text-emerald-700 space-y-1">
                                        {% for park in district_data.infrastructure.parks_list %}
                                        <li class="flex items-center">
                                            <i class="fas fa-circle text-xs text-emerald-400 mr-2"></i>
                                            {{ park }}
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Transport Accessibility -->
                <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
                        <i class="fas fa-route text-blue-600 mr-3"></i>
                        Транспортная доступность
                    </h2>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                <i class="fas fa-bus text-blue-600 mr-2"></i>
                                Общественный транспорт
                            </h3>
                            <div class="space-y-3">
                                {% if district_data.transport.bus_routes %}
                                <div class="flex items-start">
                                    <i class="fas fa-bus text-gray-600 mt-1 mr-3"></i>
                                    <div>
                                        <span class="font-medium text-gray-900">Автобусы:</span>
                                        <p class="text-gray-700">{{ district_data.transport.bus_routes|clean_transport }}</p>
                                    </div>
                                </div>
                                {% endif %}
                                {% if district_data.transport.tram_routes %}
                                <div class="flex items-start">
                                    <i class="fas fa-subway text-gray-600 mt-1 mr-3"></i>
                                    <div>
                                        <span class="font-medium text-gray-900">Трамваи:</span>
                                        <p class="text-gray-700">{{ district_data.transport.tram_routes|clean_transport }}</p>
                                    </div>
                                </div>
                                {% endif %}
                                {% if district_data.transport.trolleybus_routes %}
                                <div class="flex items-start">
                                    <i class="fas fa-bus text-gray-600 mt-1 mr-3"></i>
                                    <div>
                                        <span class="font-medium text-gray-900">Троллейбусы:</span>
                                        <p class="text-gray-700">{{ district_data.transport.trolleybus_routes|clean_transport }}</p>
                                    </div>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                                <i class="fas fa-road text-blue-600 mr-2"></i>
                                Автомобильные дороги
                            </h3>
                            <div class="space-y-3">
                                {% if district_data.transport.highways %}
                                <div class="flex items-start">
                                    <i class="fas fa-road text-gray-600 mt-1 mr-3"></i>
                                    <div>
                                        <span class="font-medium text-gray-900">Основные магистрали:</span>
                                        <p class="text-gray-700">{{ district_data.transport.highways }}</p>
                                    </div>
                                </div>
                                {% endif %}
                                {% if district_data.transport.travel_time %}
                                <div class="flex items-start">
                                    <i class="fas fa-clock text-gray-600 mt-1 mr-3"></i>
                                    <div>
                                        <span class="font-medium text-gray-900">Время до центра:</span>
                                        <p class="text-gray-700">{{ district_data.transport.travel_time }}</p>
                                    </div>
                                </div>
                                {% endif %}
                                {% if district_data.transport.parking %}
                                <div class="flex items-start">
                                    <i class="fas fa-parking text-gray-600 mt-1 mr-3"></i>
                                    <div>
                                        <span class="font-medium text-gray-900">Парковка:</span>
                                        <p class="text-gray-700">{{ district_data.transport.parking }}</p>
                                    </div>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Metro and Railway -->
                    {% if district_data.transport.metro_stations or district_data.transport.railway_stations %}
                    <div class="mt-8 grid md:grid-cols-2 gap-8">
                        {% if district_data.transport.metro_stations %}
                        <div class="bg-indigo-50 rounded-xl p-6">
                            <h3 class="text-lg font-bold text-indigo-900 mb-4 flex items-center">
                                <i class="fas fa-subway text-indigo-600 mr-2"></i>
                                Метро и станции
                            </h3>
                            <ul class="text-sm text-indigo-700 space-y-1">
                                {% for station in district_data.transport.metro_stations %}
                                <li class="flex items-center">
                                    <i class="fas fa-circle text-xs text-indigo-400 mr-2"></i>
                                    {{ station }}
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}

                        {% if district_data.transport.railway_stations %}
                        <div class="bg-amber-50 rounded-xl p-6">
                            <h3 class="text-lg font-bold text-amber-900 mb-4 flex items-center">
                                <i class="fas fa-train text-amber-600 mr-2"></i>
                                Железнодорожные станции
                            </h3>
                            <ul class="text-sm text-amber-700 space-y-1">
                                {% for station in district_data.transport.railway_stations %}
                                <li class="flex items-center">
                                    <i class="fas fa-circle text-xs text-amber-400 mr-2"></i>
                                    {{ station }}
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}
                    </div>
                    {% endif %}

                    {% if district_data.transport.accessibility_rating %}
                    <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                        <div class="flex items-center justify-between">
                            <span class="text-gray-700">Рейтинг транспортной доступности:</span>
                            <div class="flex items-center">
                                {% for i in range(5) %}
                                    {% if i < district_data.transport.accessibility_rating %}
                                    <i class="fas fa-star text-yellow-500"></i>
                                    {% else %}
                                    <i class="far fa-star text-gray-300"></i>
                                    {% endif %}
                                {% endfor %}
                                <span class="ml-2 font-medium text-gray-900">{{ district_data.transport.accessibility_rating }}/5</span>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>

                <!-- Properties in District -->
                {% if properties %}
                <div class="bg-white rounded-xl shadow-sm p-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
                        <i class="fas fa-building text-blue-600 mr-3"></i>
                        Объекты в районе
                    </h2>
                    <div class="grid md:grid-cols-2 gap-4">
                        {% for property in properties[:6] %}
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-all">
                            <h3 class="font-semibold text-gray-900 mb-2">{{ property.title }}</h3>
                            <p class="text-sm text-gray-600 mb-3">{{ property.address }}</p>
                            <div class="flex justify-between items-center">
                                <span class="text-lg font-bold text-blue-600">
                                    {{ "{:,.0f}".format(property.price) }} ₽
                                </span>
                                <span class="text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded">
                                    Кэшбек {{ "{:,.0f}".format(property.cashback) }} ₽
                                </span>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    {% if properties|length > 6 %}
                    <div class="text-center mt-6">
                        <a href="/properties?district={{ district }}" 
                           class="inline-block bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                            Смотреть все объекты ({{ properties|length }})
                        </a>
                    </div>
                    {% endif %}
                </div>
                {% endif %}

                <!-- FAQ Section -->
                <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
                        <i class="fas fa-question-circle text-blue-600 mr-3"></i>
                        Часто задаваемые вопросы о районе {{ district_data.name }}
                    </h2>
                    <div class="space-y-4">
                        <div class="border border-gray-200 rounded-lg">
                            <button class="w-full text-left p-4 font-medium text-gray-900 hover:bg-gray-50 flex justify-between items-center" onclick="toggleFAQ(0)">
                                Какая средняя цена квартир в районе {{ district_data.name }}?
                                <i class="fas fa-chevron-down transform transition-transform" id="faq-icon-0"></i>
                            </button>
                            <div class="hidden p-4 pt-0 text-gray-700 border-t" id="faq-answer-0">
                                Средняя цена за квадратный метр в районе {{ district_data.name }} составляет {{ district_data.avg_price }} рублей. При покупке через InBack вы получаете кэшбек в среднем {{ district_data.avg_cashback }} рублей.
                            </div>
                        </div>

                        <div class="border border-gray-200 rounded-lg">
                            <button class="w-full text-left p-4 font-medium text-gray-900 hover:bg-gray-50 flex justify-between items-center" onclick="toggleFAQ(1)">
                                Какая инфраструктура развита в районе {{ district_data.name }}?
                                <i class="fas fa-chevron-down transform transition-transform" id="faq-icon-1"></i>
                            </button>
                            <div class="hidden p-4 pt-0 text-gray-700 border-t" id="faq-answer-1">
                                В районе {{ district_data.name }} функционируют {{ district_data.infrastructure.schools }} школ, {{ district_data.infrastructure.kindergartens }} детских садов, {{ district_data.infrastructure.hospitals }} больниц и поликлиник, {{ district_data.infrastructure.malls }} торговых центров и {{ district_data.infrastructure.parks }} парков.
                            </div>
                        </div>

                        <div class="border border-gray-200 rounded-lg">
                            <button class="w-full text-left p-4 font-medium text-gray-900 hover:bg-gray-50 flex justify-between items-center" onclick="toggleFAQ(2)">
                                Как добраться до центра из района {{ district_data.name }}?
                                <i class="fas fa-chevron-down transform transition-transform" id="faq-icon-2"></i>
                            </button>
                            <div class="hidden p-4 pt-0 text-gray-700 border-t" id="faq-answer-2">
                                Из района {{ district_data.name }} до центра {{ current_city.name_genitive if current_city else 'Краснодара' }} можно добраться за {{ district_data.transport.travel_time }}. Доступны автобусы: {{ district_data.transport.bus_routes|clean_transport }}{% if district_data.transport.tram_routes %}, трамваи: {{ district_data.transport.tram_routes|clean_transport }}{% endif %}{% if district_data.transport.trolleybus_routes %}, троллейбусы: {{ district_data.transport.trolleybus_routes|clean_transport }}{% endif %}.
                            </div>
                        </div>

                        <div class="border border-gray-200 rounded-lg">
                            <button class="w-full text-left p-4 font-medium text-gray-900 hover:bg-gray-50 flex justify-between items-center" onclick="toggleFAQ(3)">
                                Сколько новостроек доступно в районе {{ district_data.name }}?
                                <i class="fas fa-chevron-down transform transition-transform" id="faq-icon-3"></i>
                            </button>
                            <div class="hidden p-4 pt-0 text-gray-700 border-t" id="faq-answer-3">
                                В районе {{ district_data.name }} представлено {{ district_data.properties_count }} объектов недвижимости с кэшбеком до 5%. Все новостройки от проверенных застройщиков с гарантией качества.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Related Districts -->
                <div class="bg-white rounded-xl shadow-sm p-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
                        <i class="fas fa-map-marked-alt text-blue-600 mr-3"></i>
                        Похожие районы {{ current_city.name_genitive if current_city else 'Краснодара' }}
                    </h2>
                    <div class="grid md:grid-cols-3 gap-4">
                        <a href="/district/tsentralnyy" class="block p-4 border border-gray-200 rounded-lg hover:shadow-md transition-all hover:border-blue-300">
                            <h3 class="font-semibold text-gray-900 mb-2">Центральный (ЦМР)</h3>
                            <p class="text-sm text-gray-600 mb-2">Историческое сердце города</p>
                            <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">25 объектов</span>
                        </a>
                        <a href="/district/festivalny" class="block p-4 border border-gray-200 rounded-lg hover:shadow-md transition-all hover:border-blue-300">
                            <h3 class="font-semibold text-gray-900 mb-2">Фестивальный (ФМР)</h3>
                            <p class="text-sm text-gray-600 mb-2">Престижный район</p>
                            <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">18 объектов</span>
                        </a>
                        <a href="/district/yubileynyy" class="block p-4 border border-gray-200 rounded-lg hover:shadow-md transition-all hover:border-blue-300">
                            <h3 class="font-semibold text-gray-900 mb-2">Юбилейный (ЮМР)</h3>
                            <p class="text-sm text-gray-600 mb-2">У берега Кубани</p>
                            <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">22 объекта</span>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="lg:col-span-1">
                <!-- Contact Form -->
                <div class="bg-white rounded-xl shadow-sm p-6 mb-8">
                    <h3 class="text-xl font-bold text-gray-900 mb-4">Получить консультацию</h3>
                    <p class="text-gray-600 mb-6">Наши эксперты помогут подобрать лучший объект в районе {{ district_data.name }}</p>
                    <button onclick="openApplicationModal()" 
                            class="w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                        <i class="fas fa-phone mr-2"></i>
                        Заказать звонок
                    </button>
                </div>

                <!-- District Statistics -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-xl font-bold text-gray-900 mb-4">Статистика района</h3>
                    <div class="space-y-4">
                        <div class="flex justify-between items-center py-2 border-b border-gray-100">
                            <span class="text-gray-600">Объектов в продаже:</span>
                            <span class="font-bold text-blue-600">{{ district_data.properties_count }}</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-gray-100">
                            <span class="text-gray-600">Средняя цена м²:</span>
                            <span class="font-bold text-gray-900">{{ district_data.avg_price }} ₽</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-gray-100">
                            <span class="text-gray-600">Кэшбек в среднем:</span>
                            <span class="font-bold text-blue-600">{{ district_data.avg_cashback }} ₽</span>
                        </div>
                        <div class="flex justify-between items-center py-2">
                            <span class="text-gray-600">Рейтинг района:</span>
                            <div class="flex items-center">
                                {% for i in range(5) %}
                                    {% if i < district_data.rating %}
                                    <i class="fas fa-star text-yellow-400"></i>
                                    {% else %}
                                    <i class="far fa-star text-gray-300"></i>
                                    {% endif %}
                                {% endfor %}
                                <span class="ml-2 text-sm text-gray-600">{{ district_data.rating }}/5</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Photo Slider JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Photo Slider Functions
    let currentSlide = 0;
    const totalSlides = 4;

    window.nextSlide = function() {
        currentSlide = (currentSlide + 1) % totalSlides;
        updateSlider();
    }

    window.prevSlide = function() {
        currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
        updateSlider();
    }

    window.goToSlide = function(index) {
        currentSlide = index;
        updateSlider();
    }

    function updateSlider() {
        const container = document.getElementById('sliderContainer');
        if (container) {
            const translateX = -currentSlide * 100;
            container.style.transform = `translateX(${translateX}%)`;
            
            // Update dot indicators
            document.querySelectorAll('.dot-indicator').forEach((dot, index) => {
                if (index === currentSlide) {
                    dot.classList.add('active', 'bg-opacity-100');
                    dot.classList.remove('bg-opacity-60');
                } else {
                    dot.classList.remove('active', 'bg-opacity-100');
                    dot.classList.add('bg-opacity-60');
                }
            });
        }
    }

    // Auto-slide every 5 seconds
    setInterval(() => {
        if (document.getElementById('sliderContainer')) {
            window.nextSlide();
        }
    }, 5000);

    // FAQ Toggle Functions
    window.toggleFAQ = function(index) {
        const answer = document.getElementById(`faq-answer-${index}`);
        const icon = document.getElementById(`faq-icon-${index}`);
        
        if (answer.classList.contains('hidden')) {
            answer.classList.remove('hidden');
            icon.classList.add('rotate-180');
        } else {
            answer.classList.add('hidden');
            icon.classList.remove('rotate-180');
        }
    }
});
</script>

<!-- Additional SEO Schema -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "Какая средняя цена квартир в районе {{ district_data.name }}?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Средняя цена за квадратный метр в районе {{ district_data.name }} составляет {{ district_data.avg_price }} рублей. При покупке через InBack вы получаете кэшбек в среднем {{ district_data.avg_cashback }} рублей."
      }
    },
    {
      "@type": "Question", 
      "name": "Какая инфраструктура развита в районе {{ district_data.name }}?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "В районе {{ district_data.name }} функционируют {{ district_data.infrastructure.schools }} школ, {{ district_data.infrastructure.kindergartens }} детских садов, {{ district_data.infrastructure.hospitals }} больниц и поликлиник, {{ district_data.infrastructure.malls }} торговых центров и {{ district_data.infrastructure.parks }} парков."
      }
    },
    {
      "@type": "Question",
      "name": "Как добраться до центра из района {{ district_data.name }}?", 
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Из района {{ district_data.name }} до центра {{ current_city.name_genitive if current_city else 'Краснодара' }} можно добраться за {{ district_data.transport.travel_time }}. Доступны автобусы, трамваи и троллейбусы."
      }
    }
  ]
}
</script>

{% endblock %}